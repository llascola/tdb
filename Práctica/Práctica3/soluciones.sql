/* 1 */

SELECT * FROM J;

/* 2 */

SELECT * FROM J WHERE CIUDAD='Londres';

/* 3 */

SELECT DISTINCT S 
FROM SPJ 
WHERE J='J1'
ORDER BY S;

/* 4 */

SELECT * 
FROM SPJ
WHERE CANT>=300 AND CANT<=750;

/* 5 */

SELECT DISTINCT COLOR, CIUDAD FROM P;

/* 6 */

SELECT S.S, P.P, J.J
FROM S,P,J
WHERE S.CIUDAD = P.CIUDAD AND P.CIUDAD = J.CIUDAD;

/* 7 */

SELECT S.S, P.P, J.J
FROM S,P,J
WHERE S.CIUDAD != P.CIUDAD OR P.CIUDAD != J.CIUDAD OR S.CIUDAD != J.CIUDAD;

/* 8 */

SELECT S.S, P.P, J.J
FROM S,P,J
WHERE S.CIUDAD != P.CIUDAD AND P.CIUDAD != J.CIUDAD AND S.CIUDAD != J.CIUDAD;

/* 9 */

SELECT DISTINCT P
FROM SPJ, S
WHERE S.S = SPJ.S
  AND S.CIUDAD = 'Londres'; 

/* 10 */

SELECT DISTINCT P
FROM SPJ, S, J
WHERE S.S = SPJ.S
  AND J.J = SPJ.J
  AND S.CIUDAD = 'Londres'
  AND J.CIUDAD = 'Londres';

/* 11 */

SELECT DISTINCT S.CIUDAD, J.CIUDAD
FROM SPJ, S, J
WHERE SPJ.S = S.S
  AND SPJ.J = J.J;

/* 12 */

SELECT DISTINCT P
FROM SPJ, S, J
WHERE SPJ.S = S.S
  AND SPJ.J = J.J
  AND S.CIUDAD = J.CIUDAD;

/* 13 */

SELECT DISTINCT J.J
FROM SPJ, S, J
WHERE SPJ.S = S.S
  AND SPJ.J = J.J
  AND S.CIUDAD != J.CIUDAD;

/* 14 */

SELECT DISTINCT SPJ.P, SPJ2.P
FROM SPJ, SPJ SPJ2
WHERE SPJ.S = SPJ2.S AND SPJ.P > SPJ2.P;

/* 15 */

SELECT COUNT(DISTINCT J)
FROM SPJ
WHERE S='S1';

/* 16 */

SELECT SUM(CANT)
FROM SPJ
WHERE P = 'P1' AND S = 'S1';

/* 17 */

SELECT P, J, SUM(CANT) FROM SPJ
GROUP BY P, J;

/* 18 */

SELECT DISTINCT P
FROM SPJ
GROUP BY P, J HAVING AVG(CANT) > 320;

/* 19 */

SELECT * 
FROM SPJ
WHERE CANT IS NOT NULL;

/* 20 */

SELECT P, CIUDAD
FROM P
WHERE CIUDAD LIKE '_o%';

/* 21 */

SELECT JNOMBRE
FROM J
WHERE J IN (
    SELECT J 
    FROM SPJ
    WHERE S='S1'
);

SELECT JNOMBRE
FROM J 
JOIN SPJ ON J.J =SPJ.J
WHERE SPJ.S='S1';

/* 22 */

SELECT DISTINCT COLOR
FROM P
WHERE P IN (
    SELECT P
    FROM SPJ
    WHERE S='S1'
);

SELECT DISTINCT COLOR
FROM P
JOIN SPJ ON P.P = SPJ.P
WHERE SPJ.S='S1';

/* 23 */

SELECT DISTINCT P
FROM SPJ
WHERE J IN (
    SELECT J
    FROM J
    WHERE CIUDAD = 'Londres'
);

SELECT DISTINCT P
FROM SPJ
JOIN J ON J.J = SPJ.J
WHERE CIUDAD = 'Londres';

/* 24 */

SELECT DISTINCT J
FROM SPJ
WHERE P IN (
    SELECT P 
    FROM SPJ 
    WHERE S = 'S1'
);

/* 25 */

SELECT DISTINCT S
FROM SPJ
WHERE P IN (
    SELECT P
    FROM SPJ
    WHERE S IN (
        SELECT S
        FROM SPJ
        WHERE P IN (
            SELECT P
            FROM P
            WHERE COLOR='Rojo'
        )
    )
);

/* 26 */

SELECT DISTINCT S
FROM S
WHERE SITUACION < (
    SELECT SITUACION
    FROM S
    WHERE S='S1'
);

/* 27 */

SELECT J
FROM J
WHERE CIUDAD = (
    SELECT MIN(CIUDAD) FROM J
);

/* 28 */

SELECT DISTINCT P
FROM SPJ
WHERE EXISTS (
    SELECT * 
    FROM J 
    WHERE J.J = SPJ.J AND J.CIUDAD = 'Londres'
);

/* 29 */

SELECT DISTINCT SPJ1.J
FROM SPJ SPJ1
WHERE EXISTS (
    SELECT *
    FROM SPJ SPJ2
    WHERE SPJ2.P = SPJ1.P AND SPJ2.S = 'S1' 
);

/* 30 */

SELECT J
FROM J
WHERE NOT EXISTS (
    SELECT * 
    FROM SPJ 
    WHERE J.J = J 
        AND S IN (
            SELECT S
            FROM S
            WHERE CIUDAD='Londres'
        )
        AND P IN (
            SELECT P
            FROM P
            WHERE COLOR='Rojo'
        )
);

/* 31 */

SELECT J
FROM J 
WHERE NOT EXISTS (
    SELECT *
    FROM SPJ
    WHERE J.J = J AND S != 'S1'
);

/* 32 */

SELECT CIUDAD FROM S
UNION
SELECT CIUDAD FROM P
UNION
SELECT CIUDAD FROM J
ORDER BY 1;

/* 33 */

UPDATE P
SET COLOR='Gris'
WHERE COLOR='Rojo';

/* 34 */

DELETE 
FROM J
WHERE J NOT IN (
    SELECT J 
    FROM SPJ
);

/* 35 */

INSERT INTO S (S, SNOMBRE, CIUDAD) VALUES ('S10', 'Salazar', 'Nueva York'); 